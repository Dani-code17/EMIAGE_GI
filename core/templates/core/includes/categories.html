<!-- Section Catégories -->
<section id="categories" class="py-12 px-6 bg-glass">
    <div class="max-w-6xl mx-auto">
        <h2 class="text-3xl font-display font-bold mb-12 text-center">Bibliothèque Miage</h2>
        
        <!-- Sélection du niveau -->
        <div class="mb-8 text-center">
            <label for="niveau-select" class="text-gray-300 text-lg font-bold">Sélectionnez votre niveau :</label>
            <select id="niveau-select" class="bg-dark text-gray-300 py-2 px-4 rounded-lg border border-gray-700 focus:outline-none focus:ring-2 focus:ring-primary" onchange="updateSemesters()">
                <option value="">Choisir un niveau...</option>
                <option value="l1">Licence 1</option>
                <option value="l2">Licence 2</option>
                <option value="l3">Licence 3</option>
                <option value="m1">Master 1</option>
                <option value="m2">Master 2</option>
            </select>
        </div>

        <!-- Sélection du semestre -->
        <div class="mb-8 text-center">
            <label for="semestre-select" class="text-gray-300 text-lg font-bold">Sélectionnez un semestre :</label>
            <select id="semestre-select" class="bg-dark text-gray-300 py-2 px-4 rounded-lg border border-gray-700 focus:outline-none focus:ring-2 focus:ring-primary">
                <option value="">Choisir un semestre...</option>
                <option value="s1">Semestre 1</option>
                <option value="s2">Semestre 2</option>
            </select>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
            <!-- Maquettes -->
            <button class="glass-card rounded-2xl p-6 text-center group" onclick="loadData('maquettes')">
                <div class="w-20 h-20 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center mx-auto mb-4 group-hover:rotate-12 transition">
                    <i class="fas fa-drafting-compass text-2xl text-light"></i>
                </div>
                <h3 class="font-display font-bold text-xl mb-2">Maquettes</h3>
                <p class="text-gray-400 text-sm">Découvrez la maquette de votre année universitaire !</p>
            </button>

            <!-- Cours -->
            <button class="glass-card rounded-2xl p-6 text-center group" onclick="loadData('cours')">
                <div class="w-20 h-20 bg-gradient-to-r from-secondary to-accent rounded-full flex items-center justify-center mx-auto mb-4 group-hover:rotate-12 transition">
                    <i class="fas fa-book text-2xl text-light"></i>
                </div>
                <h3 class="font-display font-bold text-xl mb-2">Cours</h3>
                <p class="text-gray-400 text-sm">Ici vous trouverez vos différents cours !</p>
            </button>

            <!-- Travaux Dirigés & Pratiques -->
            <button class="glass-card rounded-2xl p-6 text-center group" onclick="loadData('td_tp')">
                <div class="w-20 h-20 bg-gradient-to-r from-accent to-primary rounded-full flex items-center justify-center mx-auto mb-4 group-hover:rotate-12 transition">
                    <i class="fas fa-tools text-2xl text-light"></i>
                </div>
                <h3 class="font-display font-bold text-xl mb-2">Travaux Dirigés & Pratiques</h3>
                <p class="text-gray-400 text-sm">Découvrez ici les anciens sujets de TD & TP !</p>
            </button>

            <!-- Anciens Sujets -->
            <button class="glass-card rounded-2xl p-6 text-center group" onclick="loadData('anciens_sujets')">
                <div class="w-20 h-20 bg-gradient-to-r from-primary to-accent rounded-full flex items-center justify-center mx-auto mb-4 group-hover:rotate-12 transition">
                    <i class="fas fa-archive text-2xl text-light"></i>
                </div>
                <h3 class="font-display font-bold text-xl mb-2">Anciens Sujets</h3>
                <p class="text-gray-400 text-sm">Quoi de mieux que de réviser avec les anciens sujets de devoirs et d'examens !</p>
            </button>
        </div>
    </div>
</section>

<script>
    function updateSemesters() {
        const niveau = document.getElementById('niveau-select').value;
        const semestreSelect = document.getElementById('semestre-select');
        semestreSelect.innerHTML = '<option value="">Choisir un semestre...</option>';
        
        if (niveau) {
            // Uniformiser l'affichage : toujours Semestre 1 / Semestre 2 pour l'utilisateur
            // Les vues côté serveur font la conversion vers S3..S10 selon le niveau.
            let semestres = [{value: 's1', label: 'Semestre 1'}, {value: 's2', label: 'Semestre 2'}];
            
            semestres.forEach(sem => {
                const option = document.createElement('option');
                option.value = sem.value;
                option.textContent = sem.label;
                semestreSelect.appendChild(option);
            });
        }
    }

    function loadData(category) {
        const niveau = document.getElementById('niveau-select').value;
        const semestre = document.getElementById('semestre-select').value;
        
        if (!niveau || !semestre) {
            alert('Veuillez sélectionner un niveau et un semestre');
            return;
        }
        
        const params = new URLSearchParams({
            semestre: semestre,
            category: category
        });
        window.location.href = `/bibliotheque/${niveau}/?${params.toString()}`;
    }

    function scrollToCategories() {
        const categoriesSection = document.getElementById('categories');
        if (categoriesSection) {
            categoriesSection.scrollIntoView({ behavior: 'smooth' });
        }
    }

    // Mettre à jour les semestres au chargement de la page si un niveau est déjà sélectionné
    document.addEventListener('DOMContentLoaded', function() {
        const niveau = document.getElementById('niveau-select').value;
        if (niveau) {
            updateSemesters();
        }
    });
</script>
